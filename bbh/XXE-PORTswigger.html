<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width"><title>DOM Source of Selection</title><link rel="stylesheet" type="text/css" href="resource://content-accessible/viewsource.css"></head><body id="viewsource" class="highlight" style="tab-size: 4"><pre id="line1"><span></span><span class="error" title="Start tag seen without seeing a doctype first. Expected “&lt;!DOCTYPE html&gt;”.">&lt;<span class="start-tag">div</span> <span class="attribute-name">class</span>="<a class="attribute-value">maincol</a>"&gt;</span><span>
<span id="line2"></span>                        
<span id="line3"></span>    </span><span>&lt;<span class="start-tag">h1</span>&gt;</span><span>XML external entity (XXE) injection</span><span>&lt;/<span class="end-tag">h1</span>&gt;</span><span>
<span id="line4"></span>
<span id="line5"></span>
<span id="line6"></span>
<span id="line7"></span></span><span>&lt;<span class="start-tag">div</span> <span class="attribute-name">class</span>="<a class="attribute-value">sharebuttoncontainer is-smallicons</a>"&gt;</span><span>
<span id="line8"></span>    </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://twitter.com/share?url=https%3a%2f%2fportswigger.net%2fweb-security%2fxxe&amp;text=What+is+XXE+(XML+external+entity)+injection%3f+Tutorial+%26amp%3b+Examples+%7c+Web+Security+Academy%0A">https://twitter.com/share?url=https%3a%2f%2fportswigger.net%2fweb-security%2fxxe<span class="entity"><span>&amp;</span>amp;</span>text=What+is+XXE+(XML+external+entity)+injection%3f+Tutorial+%26amp%3b+Examples+%7c+Web+Security+Academy%0A</a>" <span class="attribute-name">target</span>="<a class="attribute-value">_blank</a>" <span class="attribute-name">data-ga-click-label</span>="<a class="attribute-value">twitter</a>"&gt;</span><span>
<span id="line9"></span>        </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-twitter </a>"&gt;</span><span>
<span id="line10"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-icon icon-ps-twitter</a>"&gt;</span><span></span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line11"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-text</a>"&gt;</span><span>Twitter</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line12"></span>        </span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line13"></span>    </span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>
<span id="line14"></span>    </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://api.whatsapp.com/send?text=https%3a%2f%2fportswigger.net%2fweb-security%2fxxe">https://api.whatsapp.com/send?text=https%3a%2f%2fportswigger.net%2fweb-security%2fxxe</a>" <span class="attribute-name">target</span>="<a class="attribute-value">_blank</a>" <span class="attribute-name">data-ga-click-label</span>="<a class="attribute-value">whatsapp</a>"&gt;</span><span>
<span id="line15"></span>        </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-whatsapp </a>"&gt;</span><span>
<span id="line16"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-icon icon-ps-whatsapp</a>"&gt;</span><span></span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line17"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-text</a>"&gt;</span><span>WhatsApp</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line18"></span>        </span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line19"></span>    </span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>
<span id="line20"></span>    </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://www.facebook.com/sharer.php?u=https%3a%2f%2fportswigger.net%2fweb-security%2fxxe">https://www.facebook.com/sharer.php?u=https%3a%2f%2fportswigger.net%2fweb-security%2fxxe</a>" <span class="attribute-name">target</span>="<a class="attribute-value">_blank</a>" <span class="attribute-name">data-ga-click-label</span>="<a class="attribute-value">facebook</a>"&gt;</span><span>
<span id="line21"></span>        </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-facebook </a>"&gt;</span><span>
<span id="line22"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-icon icon-ps-facebook</a>"&gt;</span><span></span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line23"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-text</a>"&gt;</span><span>Facebook</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line24"></span>        </span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line25"></span>    </span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>
<span id="line26"></span>    </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://reddit.com/submit?url=https%3a%2f%2fportswigger.net%2fweb-security%2fxxe">https://reddit.com/submit?url=https%3a%2f%2fportswigger.net%2fweb-security%2fxxe</a>" <span class="attribute-name">target</span>="<a class="attribute-value">_blank</a>" <span class="attribute-name">data-ga-click-label</span>="<a class="attribute-value">reddit</a>"&gt;</span><span>
<span id="line27"></span>        </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-reddit </a>"&gt;</span><span>
<span id="line28"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-icon icon-ps-reddit</a>"&gt;</span><span></span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line29"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-text</a>"&gt;</span><span>Reddit</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line30"></span>        </span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line31"></span>    </span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>
<span id="line32"></span>    </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://www.linkedin.com/shareArticle?url=https%3a%2f%2fportswigger.net%2fweb-security%2fxxe">https://www.linkedin.com/shareArticle?url=https%3a%2f%2fportswigger.net%2fweb-security%2fxxe</a>" <span class="attribute-name">target</span>="<a class="attribute-value">_blank</a>" <span class="attribute-name">data-ga-click-label</span>="<a class="attribute-value">linkedin</a>"&gt;</span><span>
<span id="line33"></span>        </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-linkedin </a>"&gt;</span><span>
<span id="line34"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-icon icon-ps-linkedin</a>"&gt;</span><span></span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line35"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-text</a>"&gt;</span><span>LinkedIn</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line36"></span>        </span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line37"></span>    </span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>
<span id="line38"></span>    </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="mailto:?subject=What+is+XXE+(XML+external+entity)+injection%3f+Tutorial+%26amp%3b+Examples+%7c+Web+Security+Academy&amp;body=What+is+XXE+(XML+external+entity)+injection%3f+Tutorial+%26amp%3b+Examples+%7c+Web+Security+Academy%0A%0Ahttps://portswigger.net/web-security/xxe">mailto:?subject=What+is+XXE+(XML+external+entity)+injection%3f+Tutorial+%26amp%3b+Examples+%7c+Web+Security+Academy<span class="entity"><span>&amp;</span>amp;</span>body=What+is+XXE+(XML+external+entity)+injection%3f+Tutorial+%26amp%3b+Examples+%7c+Web+Security+Academy%0A%0Ahttps://portswigger.net/web-security/xxe</a>" <span class="attribute-name">data-ga-click-label</span>="<a class="attribute-value">email</a>"&gt;</span><span>
<span id="line39"></span>        </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-email </a>"&gt;</span><span>
<span id="line40"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-icon icon-ps-email</a>"&gt;</span><span></span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line41"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">share-text</a>"&gt;</span><span>Email</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line42"></span>        </span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line43"></span>    </span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>
<span id="line44"></span></span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span>
<span id="line45"></span></span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line46"></span>            In this section, we'll explain what XML external entity injection is, describe some common examples, explain how to find and exploit various kinds of XXE injection, and summarize how to prevent XXE injection attacks.
<span id="line47"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line48"></span>        </span><span>&lt;<span class="start-tag">h2</span> <span class="attribute-name">id</span>="<a class="attribute-value">what-is-xml-external-entity-injection</a>"&gt;</span><span>What is XML external entity injection?</span><span>&lt;/<span class="end-tag">h2</span>&gt;</span><span>
<span id="line49"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line50"></span>            XML external entity injection (also known as XXE) is a web security vulnerability that allows an attacker to interfere with an application's processing of XML data. It often allows an attacker to view files on the application server filesystem, and to interact with any back-end or external systems that the application itself can access.
<span id="line51"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line52"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line53"></span>            In some situations, an attacker can escalate an XXE attack to compromise the underlying server or other back-end infrastructure, by leveraging the XXE vulnerability to perform </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/ssrf">/web-security/ssrf</a>"&gt;</span><span>server-side request forgery</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span> (SSRF) attacks.
<span id="line54"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line55"></span>        </span><span>&lt;<span class="start-tag">img</span> <span class="attribute-name">alt</span>="<a class="attribute-value">XXE injection</a>" <span class="attribute-name">src</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/images/xxe-injection.svg">/web-security/images/xxe-injection.svg</a>"&gt;</span><span>
<span id="line56"></span>        </span><span>&lt;<span class="start-tag">div</span> <span class="attribute-name">class</span>="<a class="attribute-value">component-links</a>"&gt;</span><span>
<span id="line57"></span>            </span><span>&lt;<span class="start-tag">h4</span>&gt;</span><span>Labs</span><span>&lt;/<span class="end-tag">h4</span>&gt;</span><span>
<span id="line58"></span>            </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line59"></span>                If you're already familiar with the basic concepts behind XXE vulnerabilities and just want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access all of the labs in this topic from the link below.
<span id="line60"></span>            </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line61"></span>            </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/all-labs#xml-external-entity-xxe-injection">/web-security/all-labs#xml-external-entity-xxe-injection</a>"&gt;</span><span>View all XXE labs</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>
<span id="line62"></span>        </span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span>
<span id="line63"></span>        </span><span>&lt;<span class="start-tag">h2</span> <span class="attribute-name">id</span>="<a class="attribute-value">how-do-xxe-vulnerabilities-arise</a>"&gt;</span><span>How do XXE vulnerabilities arise?</span><span>&lt;/<span class="end-tag">h2</span>&gt;</span><span>
<span id="line64"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line65"></span>            Some applications use the XML format to transmit data between the browser and the server. Applications that do this virtually always use a standard library or platform API to process the XML data on the server. XXE vulnerabilities arise because the XML specification contains various potentially dangerous features, and standard parsers support these features even if they are not normally used by the application.
<span id="line66"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line67"></span>        </span><span>&lt;<span class="start-tag">div</span> <span class="attribute-name">class</span>="<a class="attribute-value">component-links</a>"&gt;</span><span>
<span id="line68"></span>            </span><span>&lt;<span class="start-tag">h4</span>&gt;</span><span>Read more</span><span>&lt;/<span class="end-tag">h4</span>&gt;</span><span>
<span id="line69"></span>            </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/xxe/xml-entities">/web-security/xxe/xml-entities</a>"&gt;</span><span>Learn about the XML format, DTDs, and external entities</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>
<span id="line70"></span>        </span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span>
<span id="line71"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line72"></span>            XML external entities are a type of custom XML entity whose defined values are loaded from outside of the DTD in which they are declared. External entities are particularly interesting from a security perspective because they allow an entity to be defined based on the contents of a file path or URL.
<span id="line73"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line74"></span>        </span><span>&lt;<span class="start-tag">h2</span> <span class="attribute-name">id</span>="<a class="attribute-value">what-are-the-types-of-xxe-attacks</a>"&gt;</span><span>What are the types of XXE attacks?</span><span>&lt;/<span class="end-tag">h2</span>&gt;</span><span>
<span id="line75"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line76"></span>            There are various types of XXE attacks:
<span id="line77"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line78"></span>        </span><span>&lt;<span class="start-tag">ul</span>&gt;</span><span>
<span id="line79"></span>            </span><span>&lt;<span class="start-tag">li</span>&gt;</span><span>
<span id="line80"></span>                </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/xxe#exploiting-xxe-to-retrieve-files">/web-security/xxe#exploiting-xxe-to-retrieve-files</a>"&gt;</span><span>Exploiting XXE to retrieve files</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>, where an external entity is defined containing the contents of a file, and returned in the application's response.
<span id="line81"></span>            </span><span>&lt;/<span class="end-tag">li</span>&gt;</span><span>
<span id="line82"></span>            </span><span>&lt;<span class="start-tag">li</span>&gt;</span><span>
<span id="line83"></span>                </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/xxe#exploiting-xxe-to-perform-ssrf-attacks">/web-security/xxe#exploiting-xxe-to-perform-ssrf-attacks</a>"&gt;</span><span>Exploiting XXE to perform SSRF attacks</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>, where an external entity is defined based on a URL to a back-end system.
<span id="line84"></span>            </span><span>&lt;/<span class="end-tag">li</span>&gt;</span><span>
<span id="line85"></span>            </span><span>&lt;<span class="start-tag">li</span>&gt;</span><span>
<span id="line86"></span>                </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/xxe/blind#exploiting-blind-xxe-to-exfiltrate-data-out-of-band">/web-security/xxe/blind#exploiting-blind-xxe-to-exfiltrate-data-out-of-band</a>"&gt;</span><span>Exploiting blind XXE exfiltrate data out-of-band</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>, where sensitive data is transmitted from the application server to a system that the attacker controls.
<span id="line87"></span>            </span><span>&lt;/<span class="end-tag">li</span>&gt;</span><span>
<span id="line88"></span>            </span><span>&lt;<span class="start-tag">li</span>&gt;</span><span>
<span id="line89"></span>                </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/xxe/blind#exploiting-blind-xxe-to-retrieve-data-via-error-messages">/web-security/xxe/blind#exploiting-blind-xxe-to-retrieve-data-via-error-messages</a>"&gt;</span><span>Exploiting blind XXE to retrieve data via error messages</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>, where the attacker can trigger a parsing error message containing sensitive data.
<span id="line90"></span>            </span><span>&lt;/<span class="end-tag">li</span>&gt;</span><span>
<span id="line91"></span>        </span><span>&lt;/<span class="end-tag">ul</span>&gt;</span><span>
<span id="line92"></span>        </span><span>&lt;<span class="start-tag">h2</span> <span class="attribute-name">id</span>="<a class="attribute-value">exploiting-xxe-to-retrieve-files</a>"&gt;</span><span>Exploiting XXE to retrieve files</span><span>&lt;/<span class="end-tag">h2</span>&gt;</span><span>
<span id="line93"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line94"></span>            To perform an XXE injection attack that retrieves an arbitrary file from the server's filesystem, you need to modify the submitted XML in two ways:
<span id="line95"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line96"></span>        </span><span>&lt;<span class="start-tag">ul</span>&gt;</span><span>
<span id="line97"></span>            </span><span>&lt;<span class="start-tag">li</span>&gt;</span><span>
<span id="line98"></span>                Introduce (or edit) a </span><span>&lt;<span class="start-tag">code</span>&gt;</span><span>DOCTYPE</span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span> element that defines an external entity containing the path to the file.
<span id="line99"></span>            </span><span>&lt;/<span class="end-tag">li</span>&gt;</span><span>
<span id="line100"></span>            </span><span>&lt;<span class="start-tag">li</span>&gt;</span><span>
<span id="line101"></span>                Edit a data value in the XML that is returned in the application's response, to make use of the defined external entity.
<span id="line102"></span>            </span><span>&lt;/<span class="end-tag">li</span>&gt;</span><span>
<span id="line103"></span>        </span><span>&lt;/<span class="end-tag">ul</span>&gt;</span><span>
<span id="line104"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line105"></span>            For example, suppose a shopping application checks for the stock level of a product by submitting the following XML to the server:
<span id="line106"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line107"></span>        </span><span>&lt;<span class="start-tag">code</span> <span class="attribute-name">class</span>="<a class="attribute-value">code-scrollable</a>"&gt;</span><span><span class="entity"><span>&amp;</span>lt;</span>?xml version="1.0" encoding="UTF-8"?<span class="entity"><span>&amp;</span>gt;</span>
<span id="line108"></span><span class="entity"><span>&amp;</span>lt;</span>stockCheck<span class="entity"><span>&amp;</span>gt;</span><span class="entity"><span>&amp;</span>lt;</span>productId<span class="entity"><span>&amp;</span>gt;</span>381<span class="entity"><span>&amp;</span>lt;</span>/productId<span class="entity"><span>&amp;</span>gt;</span><span class="entity"><span>&amp;</span>lt;</span>/stockCheck<span class="entity"><span>&amp;</span>gt;</span></span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span>
<span id="line109"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line110"></span>            The application performs no particular defenses against XXE attacks, so you can exploit the XXE vulnerability to retrieve the </span><span>&lt;<span class="start-tag">code</span>&gt;</span><span>/etc/passwd</span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span> file by submitting the following XXE payload:
<span id="line111"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line112"></span>        </span><span>&lt;<span class="start-tag">code</span> <span class="attribute-name">class</span>="<a class="attribute-value">code-scrollable</a>"&gt;</span><span><span class="entity"><span>&amp;</span>lt;</span>?xml version="1.0" encoding="UTF-8"?<span class="entity"><span>&amp;</span>gt;</span>
<span id="line113"></span><span class="entity"><span>&amp;</span>lt;</span>!DOCTYPE foo [ <span class="entity"><span>&amp;</span>lt;</span>!ENTITY xxe SYSTEM "file:///etc/passwd"<span class="entity"><span>&amp;</span>gt;</span> ]<span class="entity"><span>&amp;</span>gt;</span>
<span id="line114"></span><span class="entity"><span>&amp;</span>lt;</span>stockCheck<span class="entity"><span>&amp;</span>gt;</span><span class="entity"><span>&amp;</span>lt;</span>productId<span class="entity"><span>&amp;</span>gt;</span><span class="entity"><span>&amp;</span>amp;</span>xxe;<span class="entity"><span>&amp;</span>lt;</span>/productId<span class="entity"><span>&amp;</span>gt;</span><span class="entity"><span>&amp;</span>lt;</span>/stockCheck<span class="entity"><span>&amp;</span>gt;</span></span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span>
<span id="line115"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line116"></span>            This XXE payload defines an external entity </span><span>&lt;<span class="start-tag">code</span>&gt;</span><span><span class="entity"><span>&amp;</span>amp;</span>xxe;</span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span> whose value is the contents of the </span><span>&lt;<span class="start-tag">code</span>&gt;</span><span>/etc/passwd</span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span> file and uses the entity within the </span><span>&lt;<span class="start-tag">code</span>&gt;</span><span>productId</span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span> value. This causes the application's response to include the contents of the file:
<span id="line117"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line118"></span>        </span><span>&lt;<span class="start-tag">code</span> <span class="attribute-name">class</span>="<a class="attribute-value">code-scrollable</a>"&gt;</span><span>Invalid product ID: root:x:0:0:root:/root:/bin/bash
<span id="line119"></span>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
<span id="line120"></span>bin:x:2:2:bin:/bin:/usr/sbin/nologin
<span id="line121"></span>...</span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span>
<span id="line122"></span>        </span><span>&lt;<span class="start-tag">div</span> <span class="attribute-name">class</span>="<a class="attribute-value">component-notes</a>"&gt;</span><span>
<span id="line123"></span>            </span><span>&lt;<span class="start-tag">h4</span>&gt;</span><span>Note</span><span>&lt;/<span class="end-tag">h4</span>&gt;</span><span>
<span id="line124"></span>            </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line125"></span>                With real-world XXE vulnerabilities, there will often be a large number of data values within the submitted XML, any one of which might be used within the application's response. To test systematically for XXE vulnerabilities, you will generally need to test each data node in the XML individually, by making use of your defined entity and seeing whether it appears within the response.
<span id="line126"></span>            </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line127"></span>        </span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span>
<span id="line128"></span>        
<span id="line129"></span>
<span id="line130"></span>    </span><span>&lt;<span class="start-tag">div</span> <span class="attribute-name">class</span>="<a class="attribute-value">widgetcontainer-lab-link is-solved</a>"&gt;</span><span>
<span id="line131"></span>        </span><span>&lt;<span class="start-tag">span</span>&gt;</span><span>LAB</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line132"></span>        </span><span>&lt;<span class="start-tag">div</span> <span class="attribute-name">class</span>="<a class="attribute-value">flex-columns</a>"&gt;</span><span>
<span id="line133"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">lab-level-display__apprentice</a>"&gt;</span><span>APPRENTICE</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line134"></span>            </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/xxe/lab-exploiting-xxe-to-retrieve-files">/web-security/xxe/lab-exploiting-xxe-to-retrieve-files</a>"&gt;</span><span>Exploiting XXE using external entities to retrieve files</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>
<span id="line135"></span>        </span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span>
<span id="line136"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">lab-status-icon</a>"&gt;</span><span>Solved</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line137"></span>    </span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span>
<span id="line138"></span>
<span id="line139"></span>        </span><span>&lt;<span class="start-tag">h2</span> <span class="attribute-name">id</span>="<a class="attribute-value">exploiting-xxe-to-perform-ssrf-attacks</a>"&gt;</span><span>Exploiting XXE to perform SSRF attacks</span><span>&lt;/<span class="end-tag">h2</span>&gt;</span><span>
<span id="line140"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line141"></span>            Aside from retrieval of sensitive data, the other main impact of XXE attacks is that they can be used to perform server-side request forgery (SSRF). This is a potentially serious vulnerability in which the server-side application can be induced to make HTTP requests to any URL that the server can access.
<span id="line142"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line143"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line144"></span>            To exploit an XXE vulnerability to perform an </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/ssrf">/web-security/ssrf</a>"&gt;</span><span>SSRF attack</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>, you need to define an external XML entity using the URL that you want to target, and use the defined entity within a data value. If you can use the defined entity within a data value that is returned in the application's response, then you will be able to view the response from the URL within the application's response, and so gain two-way interaction with the back-end system. If not, then you will only be able to perform </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/ssrf/blind">/web-security/ssrf/blind</a>"&gt;</span><span>blind SSRF</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span> attacks (which can still have critical consequences).
<span id="line145"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line146"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line147"></span>            In the following XXE example, the external entity will cause the server to make a back-end HTTP request to an internal system within the organization's infrastructure:
<span id="line148"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line149"></span>        </span><span>&lt;<span class="start-tag">code</span> <span class="attribute-name">class</span>="<a class="attribute-value">code-scrollable</a>"&gt;</span><span><span class="entity"><span>&amp;</span>lt;</span>!DOCTYPE foo [ <span class="entity"><span>&amp;</span>lt;</span>!ENTITY xxe SYSTEM "http://internal.vulnerable-website.com/"<span class="entity"><span>&amp;</span>gt;</span> ]<span class="entity"><span>&amp;</span>gt;</span></span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span>
<span id="line150"></span>        
<span id="line151"></span>
<span id="line152"></span>    </span><span>&lt;<span class="start-tag">div</span> <span class="attribute-name">class</span>="<a class="attribute-value">widgetcontainer-lab-link is-solved</a>"&gt;</span><span>
<span id="line153"></span>        </span><span>&lt;<span class="start-tag">span</span>&gt;</span><span>LAB</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line154"></span>        </span><span>&lt;<span class="start-tag">div</span> <span class="attribute-name">class</span>="<a class="attribute-value">flex-columns</a>"&gt;</span><span>
<span id="line155"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">lab-level-display__apprentice</a>"&gt;</span><span>APPRENTICE</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line156"></span>            </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/xxe/lab-exploiting-xxe-to-perform-ssrf">/web-security/xxe/lab-exploiting-xxe-to-perform-ssrf</a>"&gt;</span><span>Exploiting XXE to perform SSRF attacks</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>
<span id="line157"></span>        </span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span>
<span id="line158"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">lab-status-icon</a>"&gt;</span><span>Solved</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line159"></span>    </span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span>
<span id="line160"></span>
<span id="line161"></span>        </span><span>&lt;<span class="start-tag">h2</span> <span class="attribute-name">id</span>="<a class="attribute-value">blind-xxe-vulnerabilities</a>"&gt;</span><span>Blind XXE vulnerabilities</span><span>&lt;/<span class="end-tag">h2</span>&gt;</span><span>
<span id="line162"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line163"></span>            Many instances of XXE vulnerabilities are blind. This means that the application does not return the values of any defined external entities in its responses, and so direct retrieval of server-side files is not possible.
<span id="line164"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line165"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line166"></span>            Blind XXE vulnerabilities can still be detected and exploited, but more advanced techniques are required. You can sometimes use out-of-band techniques to find vulnerabilities and exploit them to exfiltrate data. And you can sometimes trigger XML parsing errors that lead to disclosure of sensitive data within error messages.
<span id="line167"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line168"></span>        </span><span>&lt;<span class="start-tag">div</span> <span class="attribute-name">class</span>="<a class="attribute-value">component-links</a>"&gt;</span><span>
<span id="line169"></span>            </span><span>&lt;<span class="start-tag">h4</span>&gt;</span><span>Read more</span><span>&lt;/<span class="end-tag">h4</span>&gt;</span><span>
<span id="line170"></span>            </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/xxe/blind">/web-security/xxe/blind</a>"&gt;</span><span>Finding and exploiting blind XXE vulnerabilities</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>
<span id="line171"></span>        </span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span>
<span id="line172"></span>        </span><span>&lt;<span class="start-tag">h2</span> <span class="attribute-name">id</span>="<a class="attribute-value">finding-hidden-attack-surface-for-xxe-injection</a>"&gt;</span><span>Finding hidden attack surface for XXE injection</span><span>&lt;/<span class="end-tag">h2</span>&gt;</span><span>
<span id="line173"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line174"></span>            Attack surface for XXE injection vulnerabilities is obvious in many cases, because the application's normal HTTP traffic includes requests that contain data in XML format. In other cases, the attack surface is less visible. However, if you look in the right places, you will find XXE attack surface in requests that do not contain any XML.
<span id="line175"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line176"></span>        </span><span>&lt;<span class="start-tag">h3</span> <span class="attribute-name">id</span>="<a class="attribute-value">xinclude-attacks</a>"&gt;</span><span>XInclude attacks</span><span>&lt;/<span class="end-tag">h3</span>&gt;</span><span>
<span id="line177"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line178"></span>            Some applications receive client-submitted data, embed it on the server-side into an XML document, and then parse the document. An example of this occurs when client-submitted data is placed into a back-end SOAP request, which is then processed by the backend SOAP service.
<span id="line179"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line180"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line181"></span>            In this situation, you cannot carry out a classic XXE attack, because you don't control the entire XML document and so cannot define or modify a </span><span>&lt;<span class="start-tag">code</span>&gt;</span><span>DOCTYPE</span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span> element. However, you might be able to use </span><span>&lt;<span class="start-tag">code</span>&gt;</span><span>XInclude</span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span> instead. </span><span>&lt;<span class="start-tag">code</span>&gt;</span><span>XInclude</span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span> is a part of the XML specification that allows an XML document to be built from sub-documents. You can place an </span><span>&lt;<span class="start-tag">code</span>&gt;</span><span>XInclude</span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span> attack within any data value in an XML document, so the attack can be performed in situations where you only control a single item of data that is placed into a server-side XML document.
<span id="line182"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line183"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line184"></span>            To perform an </span><span>&lt;<span class="start-tag">code</span>&gt;</span><span>XInclude</span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span> attack, you need to reference the </span><span>&lt;<span class="start-tag">code</span>&gt;</span><span>XInclude</span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span> namespace and provide the path to the file that you wish to include. For example:
<span id="line185"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line186"></span>        </span><span>&lt;<span class="start-tag">code</span> <span class="attribute-name">class</span>="<a class="attribute-value">code-scrollable</a>"&gt;</span><span><span class="entity"><span>&amp;</span>lt;</span>foo xmlns:xi="http://www.w3.org/2001/XInclude"<span class="entity"><span>&amp;</span>gt;</span>
<span id="line187"></span><span class="entity"><span>&amp;</span>lt;</span>xi:include parse="text" href="file:///etc/passwd"/<span class="entity"><span>&amp;</span>gt;</span><span class="entity"><span>&amp;</span>lt;</span>/foo<span class="entity"><span>&amp;</span>gt;</span></span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span>
<span id="line188"></span>        
<span id="line189"></span>
<span id="line190"></span>    </span><span>&lt;<span class="start-tag">div</span> <span class="attribute-name">class</span>="<a class="attribute-value">widgetcontainer-lab-link is-notsolved</a>"&gt;</span><span>
<span id="line191"></span>        </span><span>&lt;<span class="start-tag">span</span>&gt;</span><span>LAB</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line192"></span>        </span><span>&lt;<span class="start-tag">div</span> <span class="attribute-name">class</span>="<a class="attribute-value">flex-columns</a>"&gt;</span><span>
<span id="line193"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">lab-level-display__practitioner</a>"&gt;</span><span>PRACTITIONER</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line194"></span>            </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/xxe/lab-xinclude-attack">/web-security/xxe/lab-xinclude-attack</a>"&gt;</span><span>Exploiting XInclude to retrieve files</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>
<span id="line195"></span>        </span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span>
<span id="line196"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">lab-status-icon</a>"&gt;</span><span>Not solved</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line197"></span>    </span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span>
<span id="line198"></span>
<span id="line199"></span>        </span><span>&lt;<span class="start-tag">h3</span> <span class="attribute-name">id</span>="<a class="attribute-value">xxe-attacks-via-file-upload</a>"&gt;</span><span>XXE attacks via file upload</span><span>&lt;/<span class="end-tag">h3</span>&gt;</span><span>
<span id="line200"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line201"></span>            Some applications allow users to upload files which are then processed server-side. Some common file formats use XML or contain XML subcomponents. Examples of XML-based formats are office document formats like DOCX and image formats like SVG.
<span id="line202"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line203"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line204"></span>            For example, an application might allow users to upload images, and process or validate these on the server after they are uploaded. Even if the application expects to receive a format like PNG or JPEG, the image processing library that is being used might support SVG images. Since the SVG format uses XML, an attacker can submit a malicious SVG image and so reach hidden attack surface for XXE vulnerabilities.
<span id="line205"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line206"></span>        
<span id="line207"></span>
<span id="line208"></span>    </span><span>&lt;<span class="start-tag">div</span> <span class="attribute-name">class</span>="<a class="attribute-value">widgetcontainer-lab-link is-solved</a>"&gt;</span><span>
<span id="line209"></span>        </span><span>&lt;<span class="start-tag">span</span>&gt;</span><span>LAB</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line210"></span>        </span><span>&lt;<span class="start-tag">div</span> <span class="attribute-name">class</span>="<a class="attribute-value">flex-columns</a>"&gt;</span><span>
<span id="line211"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">lab-level-display__practitioner</a>"&gt;</span><span>PRACTITIONER</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line212"></span>            </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/xxe/lab-xxe-via-file-upload">/web-security/xxe/lab-xxe-via-file-upload</a>"&gt;</span><span>Exploiting XXE via image file upload</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>
<span id="line213"></span>        </span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span>
<span id="line214"></span>            </span><span>&lt;<span class="start-tag">span</span> <span class="attribute-name">class</span>="<a class="attribute-value">lab-status-icon</a>"&gt;</span><span>Solved</span><span>&lt;/<span class="end-tag">span</span>&gt;</span><span>
<span id="line215"></span>    </span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span>
<span id="line216"></span>
<span id="line217"></span>        </span><span>&lt;<span class="start-tag">h3</span> <span class="attribute-name">id</span>="<a class="attribute-value">xxe-attacks-via-modified-content-type</a>"&gt;</span><span>XXE attacks via modified content type</span><span>&lt;/<span class="end-tag">h3</span>&gt;</span><span>
<span id="line218"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line219"></span>            Most POST requests use a default content type that is generated by HTML forms, such as </span><span>&lt;<span class="start-tag">code</span>&gt;</span><span>application/x-www-form-urlencoded</span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span>. Some web sites expect to receive requests in this format but will tolerate other content types, including XML.
<span id="line220"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line221"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line222"></span>            For example, if a normal request contains the following:
<span id="line223"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line224"></span>        </span><span>&lt;<span class="start-tag">code</span> <span class="attribute-name">class</span>="<a class="attribute-value">code-scrollable</a>"&gt;</span><span>POST /action HTTP/1.0
<span id="line225"></span>Content-Type: application/x-www-form-urlencoded
<span id="line226"></span>Content-Length: 7
<span id="line227"></span>
<span id="line228"></span>foo=bar</span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span>
<span id="line229"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line230"></span>            Then you might be able submit the following request, with the same result:
<span id="line231"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line232"></span>        </span><span>&lt;<span class="start-tag">code</span> <span class="attribute-name">class</span>="<a class="attribute-value">code-scrollable</a>"&gt;</span><span>POST /action HTTP/1.0
<span id="line233"></span>Content-Type: text/xml
<span id="line234"></span>Content-Length: 52
<span id="line235"></span>
<span id="line236"></span><span class="entity"><span>&amp;</span>lt;</span>?xml version="1.0" encoding="UTF-8"?<span class="entity"><span>&amp;</span>gt;</span><span class="entity"><span>&amp;</span>lt;</span>foo<span class="entity"><span>&amp;</span>gt;</span>bar<span class="entity"><span>&amp;</span>lt;</span>/foo<span class="entity"><span>&amp;</span>gt;</span></span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span>
<span id="line237"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line238"></span>            If the application tolerates requests containing XML in the message body, and parses the body content as XML, then you can reach the hidden XXE attack surface simply by reformatting requests to use the XML format.
<span id="line239"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line240"></span>        </span><span>&lt;<span class="start-tag">h2</span> <span class="attribute-name">id</span>="<a class="attribute-value">how-to-find-and-test-for-xxe-vulnerabilities</a>"&gt;</span><span>How to find and test for XXE vulnerabilities</span><span>&lt;/<span class="end-tag">h2</span>&gt;</span><span>
<span id="line241"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line242"></span>            The vast majority of XXE vulnerabilities can be found quickly and reliably using Burp Suite's </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/burp/vulnerability-scanner">/burp/vulnerability-scanner</a>"&gt;</span><span>web vulnerability scanner</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>.
<span id="line243"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line244"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line245"></span>            Manually testing for XXE vulnerabilities generally involves:
<span id="line246"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line247"></span>        </span><span>&lt;<span class="start-tag">ul</span>&gt;</span><span>
<span id="line248"></span>            </span><span>&lt;<span class="start-tag">li</span>&gt;</span><span>
<span id="line249"></span>                Testing for </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/xxe#exploiting-xxe-to-retrieve-files">/web-security/xxe#exploiting-xxe-to-retrieve-files</a>"&gt;</span><span>file retrieval</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span> by defining an external entity based on a well-known operating system file and using that entity in data that is returned in the application's response.
<span id="line250"></span>            </span><span>&lt;/<span class="end-tag">li</span>&gt;</span><span>
<span id="line251"></span>            </span><span>&lt;<span class="start-tag">li</span>&gt;</span><span>
<span id="line252"></span>                Testing for </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/xxe/blind">/web-security/xxe/blind</a>"&gt;</span><span>blind XXE vulnerabilities</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span> by defining an external entity based on a URL to a system that you control, and monitoring for interactions with that system. </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/burp/documentation/desktop/tools/collaborator-client">/burp/documentation/desktop/tools/collaborator-client</a>"&gt;</span><span>Burp Collaborator client</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span> is perfect for this purpose.
<span id="line253"></span>            </span><span>&lt;/<span class="end-tag">li</span>&gt;</span><span>
<span id="line254"></span>            </span><span>&lt;<span class="start-tag">li</span>&gt;</span><span>
<span id="line255"></span>                Testing for vulnerable inclusion of user-supplied non-XML data within a server-side XML document by using an </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/xxe#xinclude-attacks">/web-security/xxe#xinclude-attacks</a>"&gt;</span><span>XInclude attack</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span> to try to retrieve a well-known operating system file.
<span id="line256"></span>            </span><span>&lt;/<span class="end-tag">li</span>&gt;</span><span>
<span id="line257"></span>        </span><span>&lt;/<span class="end-tag">ul</span>&gt;</span><span>
<span id="line258"></span>        </span><span>&lt;<span class="start-tag">div</span> <span class="attribute-name">class</span>="<a class="attribute-value">component-notes</a>"&gt;</span><span>
<span id="line259"></span>            </span><span>&lt;<span class="start-tag">h4</span>&gt;</span><span>Note</span><span>&lt;/<span class="end-tag">h4</span>&gt;</span><span>
<span id="line260"></span>            </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line261"></span>                Keep in mind that XML is just a data transfer format. Make sure you also test any XML-based functionality for other vulnerabilities like </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/cross-site-scripting">/web-security/cross-site-scripting</a>"&gt;</span><span>XSS</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span> and </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/sql-injection">/web-security/sql-injection</a>"&gt;</span><span>SQL injection</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>. You may need to encode your payload using XML escape sequences to avoid breaking the syntax, but you may also be able to use this to </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/web-security/reference/obfuscating-attacks-using-encodings#obfuscation-via-xml-encoding">/web-security/reference/obfuscating-attacks-using-encodings#obfuscation-via-xml-encoding</a>"&gt;</span><span>obfuscate your attack</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span> in order to bypass weak defences.
<span id="line262"></span>            </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line263"></span>        </span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span>
<span id="line264"></span>        </span><span>&lt;<span class="start-tag">h2</span> <span class="attribute-name">id</span>="<a class="attribute-value">how-to-prevent-xxe-vulnerabilities</a>"&gt;</span><span>How to prevent XXE vulnerabilities</span><span>&lt;/<span class="end-tag">h2</span>&gt;</span><span>
<span id="line265"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line266"></span>            Virtually all XXE vulnerabilities arise because the application's XML parsing library supports potentially dangerous XML features that the application does not need or intend to use. The easiest and most effective way to prevent XXE attacks is to disable those features.
<span id="line267"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line268"></span>        </span><span>&lt;<span class="start-tag">p</span>&gt;</span><span>
<span id="line269"></span>            Generally, it is sufficient to disable resolution of external entities and disable support for </span><span>&lt;<span class="start-tag">code</span>&gt;</span><span>XInclude</span><span>&lt;/<span class="end-tag">code</span>&gt;</span><span>. This can usually be done via configuration options or by programmatically overriding default behavior. Consult the documentation for your XML parsing library or API for details about how to disable unnecessary capabilities.
<span id="line270"></span>        </span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line271"></span>		        </span><span>&lt;<span class="start-tag">div</span> <span class="attribute-name">class</span>="<a class="attribute-value">component-links</a>"&gt;</span><span>
<span id="line272"></span>            </span><span>&lt;<span class="start-tag">h4</span>&gt;</span><span>Read more</span><span>&lt;/<span class="end-tag">h4</span>&gt;</span><span>
<span id="line273"></span>            </span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a class="attribute-value" href="view-source:https://portswigger.net/burp/vulnerability-scanner">/burp/vulnerability-scanner</a>"&gt;</span><span>Find XXE vulnerabilities using Burp Suite's web vulnerability scanner</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>
<span id="line274"></span>        </span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span>
<span id="line275"></span>
<span id="line276"></span>
<span id="line277"></span>                    </span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span></span></pre></body></html>